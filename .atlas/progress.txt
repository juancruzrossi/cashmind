# Progress Log

This file tracks the development progress of the project.
Atlas automatically adds entries here after completing each task.

Format:
---
## 2026-01-19 - CODE: Task Title (CATEGORY)

### Summary:
Brief description of what was implemented.

### Changes:
- file1: what changed
- file2: what changed

### PR:
https://github.com/org/repo/pull/XXX

### Notes for next developer:
Any important context or gotchas.
---

================================================================================

## 2026-01-19 - HIGH-001: Crear modelo HealthScoreSnapshot y migración (feature)

### Summary:
Added new Django model `HealthScoreSnapshot` to store monthly financial health scores with 4 individual metrics, overall score, status (semaphore), and cached Gemini advice.

### Changes:
- backend/api/models.py: Added HealthScoreSnapshot model with fields for scores, status, and advice caching
- backend/api/admin.py: Registered model with organized fieldsets
- backend/api/migrations/0006_health_score_snapshot.py: Created migration

### PR:
https://github.com/juancruzrossi/cashmind/pull/9

### Notes for next developer:
- Security tools (gitleaks, semgrep) not installed - skipped scan with warning
- Created temporary .venv to generate migration (Docker not available in this environment)
- Model uses unique_together constraint for [user, month] to prevent duplicates

## 2026-01-19 - HIGH-002: Implementar servicio de cálculo de métricas de salud financiera (feature)

### Summary:
Implemented `HealthScoreService` class with 4 financial health metric calculations, weighted overall score, traffic light status, and onboarding check. Includes 31 unit tests.

### Changes:
- backend/api/services/health_score.py: New service with MetricResult, HealthScoreResult, and HealthScoreService
- backend/api/tests/__init__.py: Created tests directory
- backend/api/tests/test_health_score.py: 31 unit tests covering all metrics and edge cases
- backend/requirements.txt: Added python-dateutil dependency

### PR:
https://github.com/juancruzrossi/cashmind/pull/10

### Notes for next developer:
- Fixed expense categories are: vivienda, servicios, transporte, seguros
- Decimal values need explicit float() conversion when multiplying with Python floats
- Security tools (gitleaks, semgrep) not installed - skipped scan with warning

## 2026-01-19 - HIGH-003: Crear endpoint API /api/health-score/ (feature)

### Summary:
Added REST endpoint `GET /api/health-score/` that returns the user's current financial health score with 4 metrics and their status. Auto-saves snapshot to database.

### Changes:
- backend/api/serializers.py: Added MetricSerializer, HealthScoreSerializer, HealthScoreSnapshotSerializer
- backend/api/views.py: Added HealthScoreView that uses HealthScoreService
- backend/api/urls.py: Added route for `/health-score/`

### PR:
https://github.com/juancruzrossi/cashmind/pull/11

### Notes for next developer:
- Response includes needs_onboarding flag for users without sufficient data
- Snapshot is auto-saved/updated on each request using update_or_create
- Security tools (gitleaks, semgrep) not installed - skipped scan with warning

## 2026-01-19 - MED-004: Agregar método de consejos financieros a GeminiService (feature)

### Summary:
Added `generate_financial_advice(metrics_data)` method to GeminiService for generating personalized financial tips based on health score metrics.

### Changes:
- backend/api/services/gemini.py: Added new method that takes metrics dict and returns AI-generated advice in Spanish

### PR:
https://github.com/juancruzrossi/cashmind/pull/12

### Notes for next developer:
- Method expects dict with: savings_rate, fixed_expenses, budget_adherence, trend (each with value and status)
- Uses temperature=0.7 for varied responses
- Security tools (gitleaks, semgrep) not installed - skipped scan with warning

## 2026-01-19 - MED-005: Crear endpoint API /api/health-score/advice/ (feature)

### Summary:
Added `GET/POST /api/health-score/advice/` endpoint to generate and cache financial advice using Gemini.

### Changes:
- backend/api/views.py: Added HealthScoreAdviceView with GET (cached or generate) and POST (regenerate) methods
- backend/api/urls.py: Added route for `/health-score/advice/`

### PR:
https://github.com/juancruzrossi/cashmind/pull/13

### Notes for next developer:
- GET returns cached advice if exists, otherwise generates new
- POST always regenerates advice (for "regenerate" button)
- Requires snapshot to exist first (call /health-score/ first)
- Security tools (gitleaks, semgrep) not installed - skipped scan with warning

## 2026-01-19 - MED-006: Crear hook useHealthScore en frontend (feature)

### Summary:
Added `useHealthScore` hook for fetching health score data from the backend API, including support for regenerating advice.

### Changes:
- frontend/src/hooks/useHealthScore.ts: New hook with states for data, advice, loading, error, needsOnboarding
- frontend/src/lib/api.ts: Added getHealthScore(), getHealthScoreAdvice(), regenerateHealthScoreAdvice() methods

### PR:
https://github.com/juancruzrossi/cashmind/pull/14

### Notes for next developer:
- Hook uses AbortController for cleanup on unmount
- Advice is fetched separately from health score data (only if not in onboarding state)
- Security tools (gitleaks, semgrep) not installed - skipped scan with warning

## 2026-01-19 - MED-007: Crear widget HealthScoreWidget para dashboard (feature)

### Summary:
Added `HealthScoreWidget` component that displays financial health as a traffic light indicator (green/yellow/red) with proper loading, error, and onboarding states.

### Changes:
- frontend/src/components/dashboard/health-score-widget.tsx: New widget component with traffic light visualization

### PR:
https://github.com/juancruzrossi/cashmind/pull/15

### Notes for next developer:
- Colors: green=#22c55e, yellow=#eab308, red=#ef4444
- Status labels in Spanish: Excelente/Regular/Necesita Atención
- Includes aria-live regions for accessibility
- Security tools (gitleaks, semgrep) not installed - skipped scan with warning

## 2026-01-19 - MED-008: Integrar widget en página de dashboard (feature)

### Summary:
Integrated `HealthScoreWidget` in the dashboard page with a "Ver detalle" link that navigates to /health. Layout is responsive: full width on mobile, 1/3 on desktop.

### Changes:
- frontend/src/app/(dashboard)/dashboard/page.tsx: Imported HealthScoreWidget and Link, added widget with navigation link

### PR:
https://github.com/juancruzrossi/cashmind/pull/16

### Notes for next developer:
- Widget placed alongside QuickActions in 1/3 column section
- Link uses primary color (#d4a853) with hover effect
- Security tools (gitleaks, semgrep) not installed - skipped scan with warning

## 2026-01-19 - MED-009: Crear página /health con sección de métricas (feature)

### Summary:
Created dedicated `/health` page with large traffic light header showing overall score and grid of 4 MetricCards for individual metrics (savings rate, fixed expenses, budget adherence, trend).

### Changes:
- frontend/src/app/(dashboard)/health/page.tsx: New page with header, error/loading/onboarding states, and metrics grid
- frontend/src/components/health/metric-card.tsx: Reusable card component with status indicator, value, and progress bar

### PR:
https://github.com/juancruzrossi/cashmind/pull/17

### Notes for next developer:
- MetricCard uses same status colors as HealthScoreWidget for consistency
- Trend icon changes based on positive/negative value (TrendingUp/TrendingDown)
- Security tools (gitleaks, semgrep) not installed - skipped scan with warning
